<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LED Matrix Dashboard â€“ Login</title>

<style>
  :root{
    --card-bg:#111827; --muted:#9CA3AF; --accent:#06b6d4;
    --glass: rgba(255,255,255,0.05);
  }
  body{
    font-family: system-ui, Roboto, Arial;
    background: linear-gradient(180deg,#071024 0%, #071827 100%);
    color: #e6eef8; margin: 0; padding: 28px;
    display:flex; flex-direction:column; min-height:100vh;
  }
  .wrap{max-width:900px;margin:0 auto;flex:1;}
  .card{
    background:var(--glass); padding:20px;border-radius:14px;
    box-shadow:0 6px 18px rgba(2,6,23,0.7);
    margin-bottom:18px;
  }
  h1{margin:0 0 16px;}
  label{display:block;font-size:0.85rem;color:var(--muted);margin-bottom:6px;}
  input[type="email"],input[type="password"],textarea,input[type="range"],input[type="color"]{
    width:100%; padding:10px; border-radius:8px;
    border:1px solid rgba(255,255,255,0.1);
    background:rgba(255,255,255,0.03); color:#fff;
  }
  button{
    background:var(--accent); color:#042;
    border:none; padding:10px 16px;
    border-radius:8px; cursor:pointer; font-weight:600;
  }
  .controls{display:flex;gap:10px;margin-top:12px;}
  footer{text-align:center;color:var(--muted);padding:12px;font-size:0.85rem;}
  #dashboard{display:none;}
  #loginBox{max-width:420px;margin:0 auto;}
</style>
</head>

<body>
<div class="wrap">

  <!-- LOGIN PAGE -->
  <div id="loginBox" class="card">
    <h1>Login</h1>
    <label>Email</label>
    <input id="email" type="email" placeholder="Enter email" />

    <label style="margin-top:12px">Password</label>
    <input id="password" type="password" placeholder="Enter password" />

    <button id="loginBtn" style="margin-top:16px;width:100%">Login</button>

    <div id="loginStatus" style="margin-top:12px;color:#f88;font-size:0.9rem;"></div>
  </div>

  <!-- DASHBOARD (Hidden until login) -->
  <div id="dashboard">
    <h1>LED Matrix Dashboard</h1>

    <div class="card">
      <label>Message</label>
      <textarea id="text" rows="3"></textarea>

      <label style="margin-top:12px">Color</label>
      <input id="colorPicker" type="color" value="#ff0000" />

      <label style="margin-top:12px">Brightness</label>
      <input id="brightness" type="range" min="0" max="255" value="150" />

      <label style="margin-top:12px">Speed (ms)</label>
      <input id="speed" type="range" min="10" max="500" value="80" />

      <div class="controls">
        <button id="applyBtn">Send</button>
        <button id="clearBtn" style="background:#7c3aed">Clear</button>
        <button id="timeBtn" style="background:#0ea5b0">Time</button>
        <button id="logoutBtn" style="background:#ef4444;color:white">Logout</button>
      </div>

      <div id="status" style="margin-top:12px;color:var(--muted);font-size:0.85rem;">
        Not connected
      </div>
    </div>
  </div>

</div>

<footer>Created by Shoaib</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// FIREBASE CONFIG (yours)
const firebaseConfig = {
  apiKey: "AIzaSyAyqyDyeQXpwZ83DVVpV1JSnH0WGB_kPKg",
  authDomain: "text-board-60a7a.firebaseapp.com",
  databaseURL: "https://text-board-60a7a-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "text-board-60a7a",
  storageBucket: "text-board-60a7a.appspot.com",
  messagingSenderId: "630642539714",
  appId: "1:630642539714:web:33d952d608232065ce0f5b"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
const PATH = "/display";


// ---------------- LOGIN LOGIC -----------------
const loginBox = document.getElementById("loginBox");
const dashboard = document.getElementById("dashboard");
const loginBtn = document.getElementById("loginBtn");
const loginStatus = document.getElementById("loginStatus");

loginBtn.addEventListener("click", ()=>{
  const email = document.getElementById("email").value;
  const pass = document.getElementById("password").value;

  auth.signInWithEmailAndPassword(email, pass)
  .then(()=>{
    loginStatus.textContent = "";
  })
  .catch(err=>{
    loginStatus.textContent = err.message;
  });
});

// Show dashboard after login
auth.onAuthStateChanged(user=>{
  if(user){
    loginBox.style.display = "none";
    dashboard.style.display = "block";
  } else {
    loginBox.style.display = "block";
    dashboard.style.display = "none";
  }
});

// Logout
document.getElementById("logoutBtn").onclick = ()=>{
  auth.signOut();
};



// ---------------- DASHBOARD FUNCTIONS -----------------
function hexToRgb(hex){
  hex = hex.replace("#","");
  return [
    parseInt(hex.substring(0,2),16),
    parseInt(hex.substring(2,4),16),
    parseInt(hex.substring(4,6),16)
  ];
}

function sendData(text, r, g, b, bright, spd){
  db.ref(PATH).update({
    text: text,
    color: `${r},${g},${b}`,
    brightness: bright,
    speed: spd
  }).then(()=>{
    document.getElementById("status").textContent = "Updated: " + new Date().toLocaleTimeString();
  });
}

// UI buttons
document.getElementById("applyBtn").onclick = ()=>{
  const [r,g,b] = hexToRgb(colorPicker.value);
  sendData(text.value, r,g,b, brightness.value, speed.value);
};

document.getElementById("clearBtn").onclick = ()=>{
  sendData("", 0,0,0, 0, 100);
};

document.getElementById("timeBtn").onclick = ()=>{
  const now = new Date();
  const t = now.toLocaleTimeString();
  const [r,g,b] = hexToRgb(colorPicker.value);
  sendData(t, r,g,b, brightness.value, speed.value);
};

db.ref(PATH).on("value", ()=>{
  document.getElementById("status").textContent = "Connected";
});
</script>
</body>
</html>
